---
import { getCollection } from "astro:content";
import Layout from "@layouts/Layout.astro";
import Container from "@components/container.astro";
import { Image } from "@astrojs/image/components";

export async function getStaticPaths() {
  const menuEntries = await getCollection("menus");
  return menuEntries.map((entry) => ({
    params: { slug: entry.id.toLowerCase() },
    props: { entry },
  }));
}

const menuEntryLinks = await getCollection("menus");

const { entry } = Astro.props;
---

<Layout title={entry.data.title}>
  <div class="flex justify-center items-center h-64 bg-[#fb3bb3] mb-12">
    <h1 class="text-6xl md:text-8xl font-sans text-slate-200">Menus</h1>
  </div>
  <Container>
    <div class="flex justify-center gap-4 mt-8 mb-16">
      {
        menuEntryLinks.map((e) => (
          <>
            <a
              href={`/menu/${e.id.toLowerCase()}`}
              class={`${
                entry.id === e.id ? "text-[#00b74f]" : "text-white bg-[#00b74f]"
              } hover:text-white hover:bg-[#00b74f] font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 border border-[#00b74f]`}>
              {e.id}
            </a>
          </>
        ))
      }
    </div>
    {
      !entry.data.pictureOrText ? (
        <div class="grid grid-cols-1 md:grid-cols-2 gap-16">
          {entry.data.subsection.map((s) => (
            <>
              <div class="col-span-1">
                <div class="mb-4">
                  <h1 class="text-4xl md:text-6xl font-sans">{s.title}</h1>
                </div>
                {s.menuItems.map((item) => (
                  <>
                    <div class="grid grid-cols-3 mb-4 gap-4">
                      <div class="col-span-2">
                        <p class="float-left">
                          <strong>{item.name}</strong> : {item.description}
                        </p>
                      </div>
                      <div>
                        <p class="float-right">{item.price}</p>
                      </div>
                    </div>
                  </>
                ))}
              </div>
            </>
          ))}
        </div>
      ) : (
        <div>
          <Image src={entry.data.menuPicture} alt="Menu Image" />
        </div>
      )
    }
  </Container>
</Layout>
